<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Store · simpleS</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="[0]: /docs/router#session"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Store · simpleS"/><meta property="og:type" content="website"/><meta property="og:url" content="https://simples.js.org/"/><meta property="og:description" content="[0]: /docs/router#session"/><meta property="og:image" content="https://simples.js.org/img/logo.svg"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/foundation.min.css"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-136434169-1"></script><script>
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments); }
              gtag('js', new Date());
              gtag('config', 'UA-136434169-1');
            </script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/logo-white.svg" alt="simpleS"/></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/" target="_self">Docs</a></li><li class=""><a href="https://npmjs.org/package/simples" target="_self">npm</a></li><li class=""><a href="https://github.com/micnic/simpleS" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>General</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Docs</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/">Index</a></li><li class="navListItem"><a class="navItem" href="/docs/start">Get Started</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Reference</h3><ul class=""><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">General</h4><ul><li class="navListItem"><a class="navItem" href="/docs/server">Server</a></li><li class="navListItem"><a class="navItem" href="/docs/mirror">Mirror</a></li><li class="navListItem"><a class="navItem" href="/docs/session">Session</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/store">Store</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">HTTP</h4><ul><li class="navListItem"><a class="navItem" href="/docs/http-host">HTTPHost</a></li><li class="navListItem"><a class="navItem" href="/docs/router">Router</a></li><li class="navListItem"><a class="navItem" href="/docs/http-connection">HTTPConnection</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">WS</h4><ul><li class="navListItem"><a class="navItem" href="/docs/ws-host">WSHost</a></li><li class="navListItem"><a class="navItem" href="/docs/ws-channel">WSChannel</a></li><li class="navListItem"><a class="navItem" href="/docs/ws-connection">WSConnection</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Client</h4><ul><li class="navListItem"><a class="navItem" href="/docs/client">Client</a></li><li class="navListItem"><a class="navItem" href="/docs/client-request">ClientRequest</a></li><li class="navListItem"><a class="navItem" href="/docs/client-connection">ClientConnection</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Info</h4><ul><li class="navListItem"><a class="navItem" href="/docs/logging">Logging</a></li></ul></div></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">Store</h1></header><article><div><span><p><code>simpleS</code> uses store implementations to deposit session objects.</p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">const</span> simples = <span class="hljs-built_in">require</span>(<span class="hljs-string">'simples'</span>);

<span class="hljs-keyword">const</span> store = simples.store();
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="memory-store"></a><a href="#memory-store" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Memory Store</h2>
<p>By default <code>simpleS</code> uses a memcached store for sessions, which is by design not
persistent, leaks memory, does not scale and is meant only for development
purpose. For production purpose a custom store implementation should be used. To
create a memory store <code>simples.store()</code> method should be called without any
parameters.</p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">const</span> store = simples.store();
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="store-implementation"></a><a href="#store-implementation" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Store Implementation</h2>
<p>Third party store implementations have to implement four methods, <code>.get()</code>,
<code>.set()</code>, <code>.remove()</code> and <code>.update()</code>, to be compliant with the <code>simpleS</code>
session management system.</p>
<p><code>.get(id)</code> - method to get a session by the session id from the store, it should
return a promise that resolves with the session or with <code>null</code> if the session
was not found.</p>
<p><code>.set(id, session, timeout)</code> - method to save a session to the store providing
the session id, the session object and the session timeout, it should return a
promise that resolves in case of a successful save.</p>
<p><code>.remove(id)</code> - method to remove a session from the store providing the session
id, it should return a promise that resolves in case of a successful removal.</p>
<p><code>.update(id, timeout)</code> - method to update the session by providing session id
and the session timeout, it should return a promise that resolves in case of
successful update. This method is optional for store implementations, but it is
highly recommended as it is used to mark the session as active by updating its
timeout in case it was not modified but just accessed.</p>
<p>The easiest way to create a custom store is to use <code>simples.store()</code> method
called with an object as parameter, the object has to implement the required
methods for the store.</p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">const</span> store = simples.store({

    <span class="hljs-comment">// id: string</span>
    <span class="hljs-keyword">get</span>(id) {
        <span class="hljs-comment">// Store get method implementation</span>
        <span class="hljs-comment">// Should return a promise</span>
        <span class="hljs-comment">// The returned promise should resolve with the session value if found</span>
        <span class="hljs-comment">// The returned promise should resolve with null if no session is found</span>
    },

    <span class="hljs-comment">// id: string</span>
    <span class="hljs-comment">// session: simples.Session</span>
    <span class="hljs-comment">// timeout: number</span>
    <span class="hljs-keyword">set</span>(id, session, timeout) {
        <span class="hljs-comment">// Store set method implementation</span>
        <span class="hljs-comment">// Should return a promise</span>
        <span class="hljs-comment">// The returned promise should resolve in case of a successful save</span>
    },

    <span class="hljs-comment">// id: string</span>
    remove(id) {
        <span class="hljs-comment">// Store remove method implementation</span>
        <span class="hljs-comment">// Should return a promise</span>
        <span class="hljs-comment">// The returned promise should resolve in case of a successful removal</span>
    }

    <span class="hljs-comment">// id: string</span>
    <span class="hljs-comment">// timeout: number</span>
    update(id, timeout) {
        <span class="hljs-comment">// Store remove update implementation</span>
        <span class="hljs-comment">// Should return a promise</span>
        <span class="hljs-comment">// The returned promise should resolve in case of a successful update</span>
    }
});
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="usage"></a><a href="#usage" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Usage</h2>
<p>Stores are used in the router configuration objects</p>
<pre><code class="hljs css language-js"><span class="hljs-comment">// On server creation the store is used inside the main host configuration</span>
<span class="hljs-keyword">const</span> server = simples();

server.config({         <span class="hljs-comment">// Main router configuration</span>
    session: {          <span class="hljs-comment">// Main router session configuration</span>
        enabled: <span class="hljs-literal">true</span>,  <span class="hljs-comment">// Session enabled</span>
        store           <span class="hljs-comment">// Store instance</span>
    }
});

<span class="hljs-comment">// or use the shortcut method</span>
server.session({        <span class="hljs-comment">// Main router session configuration</span>
    enabled: <span class="hljs-literal">true</span>,      <span class="hljs-comment">// Session enabled</span>
    store               <span class="hljs-comment">// Store instance</span>
});

<span class="hljs-comment">// In the same way store instances can be used on host or router configuration</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="see-also"></a><a href="#see-also" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>See also</h3>
<p><a href="/docs/router#session">Router session configuration</a></p>
<p><a href="/docs/session">Session documentation</a></p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/session"><span class="arrow-prev">← </span><span>Session</span></a><a class="docs-next button" href="/docs/http-host"><span>HTTPHost</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#memory-store">Memory Store</a></li><li><a href="#store-implementation">Store Implementation</a></li><li><a href="#usage">Usage</a><ul class="toc-headings"><li><a href="#see-also">See also</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/logo-square.svg" alt="simpleS" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/en/index">Index</a><a href="/docs/en/start">Get Started</a></div><div><h5>More</h5><a href="https://npmjs.org/package/simples">npm</a><a href="https://github.com/micnic/simpleS">GitHub</a><a class="github-button" href="https://github.com/micnic/simples" data-icon="octicon-star" data-count-href="/micnic/simples/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><section class="copyright">Copyright © 2012 - 2019 Nicu Micleușanu</section></footer></div></body></html>